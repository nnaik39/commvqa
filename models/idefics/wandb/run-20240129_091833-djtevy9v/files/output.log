


Loading checkpoint shards: 100%|██████████████████| 2/2 [03:13<00:00, 96.64s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Using sep_token, but it is not set yet.
Using cls_token, but it is not set yet.
Using mask_token, but it is not set yet.
  0%|                                                  | 0/1124 [00:00<?, ?it/s]
Question:  Assume someone is browsing a travel website when they encounter this image. They cannot see the image directly, but they can access this image description: A stingray blends into sandy ocean bottom, its shape barely discernible except for two eyes and a slender tail. Based on this description, they asked this follow-up question. Please answer based on the image. In your answer, prioritize details relevant to this person. Question: Are there any other creatures or objects present in this photo?

  0%|                                        | 1/1124 [00:21<6:39:36, 21.35s/it]
Question:  Assume someone is browsing a shopping website when they encounter this image. They cannot see the image directly, but they can access this image description: Close-up of hands strumming a resonator guitar, showcasing fingers on strings and the guitar's body. Based on this description, they asked this follow-up question. Please answer based on the image. In your answer, prioritize details relevant to this person. Question: Is the guitar (assuming that's what is being sold) electric or acoustic?
  0%|                                        | 2/1124 [00:30<4:49:24, 15.48s/it]
Traceback (most recent call last):
  File "/juice2/scr2/nanditan/commvqa/idefics/eval_idefics.py", line 108, in <module>
    generated_ids = model.generate(**inputs, eos_token_id=exit_condition, bad_words_ids=bad_words_ids, max_new_tokens=256, do_sample=False, num_beams=1)
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/transformers/generation/utils.py", line 1606, in generate
    return self.greedy_search(
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/transformers/generation/utils.py", line 2454, in greedy_search
    outputs = self(
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/transformers/models/idefics/modeling_idefics.py", line 1516, in forward
    outputs = self.model(
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/transformers/models/idefics/modeling_idefics.py", line 1358, in forward
    layer_outputs = vblock(
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/transformers/models/idefics/modeling_idefics.py", line 1322, in vblock
    layer_outputs = main_block(
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/transformers/models/idefics/modeling_idefics.py", line 774, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/transformers/models/idefics/modeling_idefics.py", line 678, in forward
    query_states, key_states = apply_rotary_pos_emb(query_states, key_states, cos, sin, position_ids)
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/transformers/models/idefics/modeling_idefics.py", line 549, in apply_rotary_pos_emb
    k_embed = (k * cos) + (rotate_half(k) * sin)
KeyboardInterrupt