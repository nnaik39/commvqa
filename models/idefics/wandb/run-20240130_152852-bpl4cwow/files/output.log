

Loading checkpoint shards: 100%|██████████████████| 2/2 [00:02<00:00,  1.21s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Using sep_token, but it is not set yet.
Using cls_token, but it is not set yet.
Using mask_token, but it is not set yet.
  0%|                                                  | 0/1215 [00:08<?, ?it/s]
Traceback (most recent call last):
  File "/juice2/scr2/nanditan/commvqa/idefics/eval_idefics.py", line 102, in <module>
    metrics_dict = evaluate_metrics(refs, generated_answer, ['../' + image_path])
  File "/juice2/scr2/nanditan/commvqa/idefics/eval_idefics.py", line 27, in evaluate_metrics
    sample = random.sample(indices, int(0.8 * len(refs)))
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/random.py", line 433, in sample
    raise TypeError("Population must be a sequence.  For dicts or sets, use sorted(d).")
TypeError: Population must be a sequence.  For dicts or sets, use sorted(d).