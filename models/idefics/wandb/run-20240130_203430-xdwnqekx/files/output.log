


Loading checkpoint shards: 100%|██████████████████| 2/2 [00:04<00:00,  2.07s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Using sep_token, but it is not set yet.
Using cls_token, but it is not set yet.
Using mask_token, but it is not set yet.
  0%|                                                  | 0/1215 [00:00<?, ?it/s]
Refs  [[['there are not any other objects.', 'small fish', 'there are no other creatures or objects around the stingray']]]
  0%|                                                  | 0/1215 [00:00<?, ?it/s]/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
  0%|                                                  | 0/1215 [00:20<?, ?it/s]
Traceback (most recent call last):
  File "/juice2/scr2/nanditan/commvqa/idefics/eval_idefics.py", line 145, in <module>
    metrics_dict = evaluate_metrics(refs, [generated_answer], ['../' + image_path], 1)
  File "/juice2/scr2/nanditan/commvqa/idefics/eval_idefics.py", line 70, in evaluate_metrics
    _, per_instance_image_text, candidate_feats = get_clip_score(
  File "/juice2/scr2/nanditan/commvqa/idefics/clipscore_helper.py", line 158, in get_clip_score
    images = extract_all_images(images, model, device)
  File "/juice2/scr2/nanditan/commvqa/idefics/clipscore_helper.py", line 144, in extract_all_images
    all_image_features.append(model.encode_image(b).cpu().numpy())
  File "/nlp/scr/nanditan/miniconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1695, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'IdeficsForVisionText2Text' object has no attribute 'encode_image'